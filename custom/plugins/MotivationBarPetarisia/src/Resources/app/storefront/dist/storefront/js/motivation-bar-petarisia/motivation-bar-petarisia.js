(()=>{"use strict";var t={156:t=>{var e=function(t){var e;return!!t&&"object"==typeof t&&"[object RegExp]"!==(e=Object.prototype.toString.call(t))&&"[object Date]"!==e&&t.$$typeof!==i},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function s(t,e){return!1!==e.clone&&e.isMergeableObject(t)?o(Array.isArray(t)?[]:{},t,e):t}function l(t,e,i){return t.concat(e).map(function(t){return s(t,i)})}function a(t){return Object.keys(t).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[])}function r(t,e){try{return e in t}catch(t){return!1}}function o(t,i,n){(n=n||{}).arrayMerge=n.arrayMerge||l,n.isMergeableObject=n.isMergeableObject||e,n.cloneUnlessOtherwiseSpecified=s;var h,c,u=Array.isArray(i);return u!==Array.isArray(t)?s(i,n):u?n.arrayMerge(t,i,n):(c={},(h=n).isMergeableObject(t)&&a(t).forEach(function(e){c[e]=s(t[e],h)}),a(i).forEach(function(e){(!r(t,e)||Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))&&(r(t,e)&&h.isMergeableObject(i[e])?c[e]=(function(t,e){if(!e.customMerge)return o;var i=e.customMerge(t);return"function"==typeof i?i:o})(e,h)(t[e],i[e],h):c[e]=s(i[e],h))}),c)}o.all=function(t,e){if(!Array.isArray(t))throw Error("first argument should be an array");return t.reduce(function(t,i){return o(t,i,e)},{})},t.exports=o}},e={};function i(s){var l=e[s];if(void 0!==l)return l.exports;var a=e[s]={exports:{}};return t[s](a,a.exports,i),a.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var s=i(156),l=i.n(s);class a{static ucFirst(t){return t.charAt(0).toUpperCase()+t.slice(1)}static lcFirst(t){return t.charAt(0).toLowerCase()+t.slice(1)}static toDashCase(t){return t.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}static toLowerCamelCase(t,e){let i=a.toUpperCamelCase(t,e);return a.lcFirst(i)}static toUpperCamelCase(t,e){return e?t.split(e).map(t=>a.ucFirst(t.toLowerCase())).join(""):a.ucFirst(t.toLowerCase())}static parsePrimitive(t){try{return/^\d+(.|,)\d+$/.test(t)&&(t=t.replace(",",".")),JSON.parse(t)}catch(e){return t.toString()}}}class r{constructor(t=document){this._el=t,t.$emitter=this,this._listeners=[]}publish(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=new CustomEvent(t,{detail:e,cancelable:i});return this.el.dispatchEvent(s),s}subscribe(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=this,l=t.split("."),a=i.scope?e.bind(i.scope):e;if(i.once&&!0===i.once){let e=a;a=function(i){s.unsubscribe(t),e(i)}}return this.el.addEventListener(l[0],a),this.listeners.push({splitEventName:l,opts:i,cb:a}),!0}unsubscribe(t){let e=t.split(".");return this.listeners=this.listeners.reduce((t,i)=>([...i.splitEventName].sort().toString()===e.sort().toString()?this.el.removeEventListener(i.splitEventName[0],i.cb):t.push(i),t),[]),!0}reset(){return this.listeners.forEach(t=>{this.el.removeEventListener(t.splitEventName[0],t.cb)}),this.listeners=[],!0}get el(){return this._el}set el(t){this._el=t}get listeners(){return this._listeners}set listeners(t){this._listeners=t}}class o{constructor(t,e={},i=!1){if(!(t instanceof Node)){console.warn(`There is no valid element given while trying to create a plugin instance for "${i}".`);return}this.el=t,this.$emitter=new r(this.el),this._pluginName=this._getPluginName(i),this.options=this._mergeOptions(e),this._initialized=!1,this._registerInstance(),this._init()}init(){console.warn(`The "init" method for the plugin "${this._pluginName}" is not defined. The plugin will not be initialized.`)}update(){}_init(){this._initialized||(this.init(),this._initialized=!0)}_update(){this._initialized&&this.update()}_mergeOptions(t){let e=[this.constructor.options,this.options,t];return e.push(this._getConfigFromDataAttribute()),e.push(this._getOptionsFromDataAttribute()),l().all(e.filter(t=>t instanceof Object&&!(t instanceof Array)).map(t=>t||{}))}_getConfigFromDataAttribute(){let t={};if("function"!=typeof this.el.getAttribute)return t;let e=a.toDashCase(this._pluginName),i=this.el.getAttribute(`data-${e}-config`);return i?window.PluginConfigManager.get(this._pluginName,i):t}_getOptionsFromDataAttribute(){let t={};if("function"!=typeof this.el.getAttribute)return t;let e=a.toDashCase(this._pluginName),i=this.el.getAttribute(`data-${e}-options`);if(i)try{return JSON.parse(i)}catch(t){console.error(`The data attribute "data-${e}-options" could not be parsed to json: ${t.message}`)}return t}_registerInstance(){window.PluginManager.getPluginInstancesFromElement(this.el).set(this._pluginName,this),window.PluginManager.getPlugin(this._pluginName,!1).get("instances").push(this)}_getPluginName(t){return t||(t=this.constructor.name),t}}PluginManager.register("MotivationBar",class extends o{init(){this.currentTotal=parseFloat(this.el.dataset.currentTotal||"0"),this.maxGoal=parseFloat(this.el.dataset.maxGoal||"0"),this.progress=parseFloat(this.el.dataset.progress||"0"),this.fillEl=this.el.querySelector(".motivation-bar__fill"),this.tooltipEl=this.el.querySelector("[data-mb-tooltip]"),this.tooltipTextEl=this.el.querySelector("[data-mb-tooltip-text]"),this.messageEl=this.el.querySelector("[data-mb-message]"),this.modalOverlayEl=this.el.querySelector("[data-mb-modal-overlay]"),this.modalEl=this.el.querySelector("[data-mb-modal]"),this.modalCloseEl=this.el.querySelector("[data-mb-modal-close]"),this.modalTitleEl=this.el.querySelector("[data-mb-modal-title]"),this.modalBodyEl=this.el.querySelector("[data-mb-modal-body]"),this.modalIconEl=this.el.querySelector("[data-mb-modal-icon]"),this.modalStatusEl=this.el.querySelector("[data-mb-modal-status]");try{this.goals=JSON.parse(this.el.dataset.goals||"[]")}catch(t){this.goals=[]}this.locale=this.el.dataset.locale||"en-US",this.currency=this.el.dataset.currency||"EUR",this._applyProgress(),this._updateMessage(),this._updateMilestones(),this._bindTooltipEvents(),this._bindModalEvents()}_applyProgress(){if(!this.fillEl)return;let t=Math.max(0,Math.min(100,this.progress)),e="mb_last_progress_pct",i=window.sessionStorage.getItem(e),s=null!==i?parseFloat(i):null,l=Number.isFinite(s)?Math.max(0,Math.min(100,s)):t;this.fillEl.style.transition="none",this.fillEl.style.width=`${l}%`,this.fillEl.offsetWidth,this.fillEl.style.transition="",requestAnimationFrame(()=>{this.fillEl.style.width=`${t}%`}),window.sessionStorage.setItem(e,String(t))}_formatMoney(t){return new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency}).format(t)}_updateMessage(){if(!this.messageEl)return;let t=[...this.goals].sort((t,e)=>t.amount-e.amount),e=t.find(t=>this.currentTotal<t.amount);if(!e){let e=t.map(t=>t.label),i="";1===e.length?i=e[0]:2===e.length?i=`${e[0]} and ${e[1]}`:e.length>2&&(i=`${e.slice(0,-1).join(", ")} and ${e.at(-1)}`),this.messageEl.textContent=`Nice! You have ${i} ðŸŽ‰`;return}let i=e.amount-this.currentTotal;this.messageEl.textContent=`You only need ${this._formatMoney(i)} for ${e.label}!`}_updateMilestones(){this.el.querySelectorAll("[data-mb-goal]").forEach(t=>{let e=parseFloat(t.dataset.goalAmount||"0"),i=this.currentTotal>=e,s=t.classList.contains("is-reached");if(t.classList.toggle("is-reached",i),t.setAttribute("aria-disabled",i?"false":"true"),t.tabIndex=i?0:-1,!s&&i){let e=t.querySelector(".motivation-bar__goalDot");e&&(e.classList.remove("is-pop"),e.offsetWidth,e.classList.add("is-pop"),e.addEventListener("animationend",()=>{e.classList.remove("is-pop")},{once:!0}))}})}_bindTooltipEvents(){let t=this.el.querySelectorAll("[data-mb-goal]");this.tooltipEl&&this.tooltipTextEl&&t.length&&t.forEach(t=>{console.log(t),t.addEventListener("mouseenter",()=>{this.tooltipTextEl.textContent=t.dataset.goalLabel||"",this.tooltipEl.hidden=!1;let e=this.el.querySelector(".motivation-bar__track-wrapper").getBoundingClientRect(),i=t.getBoundingClientRect(),s=i.left+i.width/2-e.left,l=this.tooltipEl.offsetWidth,a=l/2,r=Math.max(a,Math.min(e.width-a,s));this.tooltipEl.style.left=`${r}px`;let o=s-(r-a);o=Math.max(7,Math.min(l-7,o)),this.tooltipEl.style.setProperty("--arrow-x",`${o}px`),this.tooltipEl.classList.add("is-visible")}),t.addEventListener("mouseleave",()=>{this.tooltipEl.classList.remove("is-visible"),this.tooltipEl.hidden=!0})})}_bindModalEvents(){let t=this.el.querySelectorAll("[data-mb-goal]");this.modalOverlayEl&&this.modalEl&&t.length&&(t.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),"true"!==t.getAttribute("aria-disabled")&&this._openModalFromGoal(t)})}),this.modalCloseEl&&this.modalCloseEl.addEventListener("click",t=>{t.preventDefault(),this._closeModal()}),this.modalOverlayEl.addEventListener("click",t=>{t.target===this.modalOverlayEl&&this._closeModal()}),document.addEventListener("keydown",t=>{"Escape"!==t.key||this.modalOverlayEl.hidden||this._closeModal()}))}_openModalFromGoal(t){let e=t.dataset.goalLabel||"",i=t.dataset.goalDescription||"",s=t.dataset.goalIcon||"",l=parseFloat(t.dataset.goalAmount||"0"),a=this.currentTotal>=l,r=Math.max(0,l-this.currentTotal);if(this.modalTitleEl&&(this.modalTitleEl.textContent=e),this.modalBodyEl&&(this.modalBodyEl.textContent=i),this.modalStatusEl&&(a?this.modalStatusEl.textContent=`Unlocked ðŸŽ‰`:this.modalStatusEl.textContent=`Spend ${this._formatMoney(r)} more to unlock`),this.modalIconEl){this.modalIconEl.innerHTML="";let t=this.el.querySelector(`[data-mb-icon-template="${CSS.escape(s)}"]`);t&&(this.modalIconEl.innerHTML=t.innerHTML)}this.modalOverlayEl.hidden=!1,this.modalEl.setAttribute("aria-hidden","false")}_closeModal(){this.modalEl.setAttribute("aria-hidden","true"),this.modalOverlayEl.hidden=!0}},"[data-motivation-bar]")})();