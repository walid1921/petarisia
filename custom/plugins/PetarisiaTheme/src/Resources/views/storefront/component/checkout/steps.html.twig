{% set route = app.request.attributes.get('_route') %}
{% set currentStep = 1 %}

{# Cart #}
{% if route == 'frontend.checkout.cart.page' %}
    {% set currentStep = 1 %}
{% endif %}

{#{% if route == 'frontend.checkout.shipping.page' %}#}
{#    {% set currentStep = 2 %}#}
{#{% endif %}#}

{# Confirm (the “checkout” page after cart) #}
{% if route == 'frontend.checkout.confirm.page' %}
    {% set currentStep = 2 %}
{% endif %}

{#{% if route == 'frontend.checkout.payment.page' %}#}
{#    {% set currentStep = 4 %}#}
{#{% endif %}#}

{# Finish #}
{% if route == 'frontend.checkout.finish.page' %}
    {% set currentStep = 3 %}
{% endif %}

{#{% set steps = [#}
{#    { key: 'order', label: 'Your Order', index: 1, icon: 'bag', link: path('frontend.checkout.cart.page') },#}
{#    { key: 'ship', label: 'Shipping', index: 2, icon: 'marker', link: path('frontend.checkout.confirm.page') },#}
{#    { key: 'confirm', label: 'Confirmation', index: 3, icon: 'list', link: path('frontend.checkout.confirm.page') },#}
{#    { key: 'pay', label: 'Payment', index: 4, icon: 'money-card', link: path('frontend.checkout.confirm.page') },#}
{#    { key: 'done', label: 'Order complete', index: 5, icon: 'checkmark', link: path('frontend.checkout.finish.page') }#}
{#] %}#}

{% set steps = [
    { key: 'order', label: 'Your Order', index: 1, icon: 'bag', link: path('frontend.checkout.cart.page') },
    { key: 'confirm', label: 'Checkout', index: 2, icon: 'money-card', link: path('frontend.checkout.confirm.page') },
    { key: 'done', label: 'Order complete', index: 3, icon: 'checkmark', link: path('frontend.checkout.finish.page') }
] %}


<nav class="sw-checkout-steps" aria-label="Checkout steps">
    <ol class="sw-checkout-steps__list">
        {% for step in steps %}
            {% set isDone = step.index < currentStep %}
            {% set isActive = step.index == currentStep %}
            {% set isOrdered = step.key == 'done' %}

            <li class="sw-checkout-steps__item
                {{ isDone ? 'is-done' : '' }}
                {{ isActive ? 'is-active' : '' }}
                {{ route == 'frontend.checkout.finish.page' ? 'is-done' : '' }}
            ">
                <a  href="{{ step.link }}"
                    class="sw-checkout-steps__dot" aria-hidden="true">
                    {% if isDone or route == 'frontend.checkout.finish.page' %}
                        {% sw_icon 'checkmark' %}
                    {% else %}
                        {% sw_icon  step.icon style {
                            'size': 'sm'
                        } %}
                    {% endif %}
                </a>

                <span class="sw-checkout-steps__label">{{ step.label }}</span>
            </li>
        {% endfor %}
    </ol>
</nav>
